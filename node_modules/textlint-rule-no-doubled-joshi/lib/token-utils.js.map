{"version":3,"file":"token-utils.js","names":["Object","defineProperty","exports","value","restoreToSurfaceFromKey","is括弧Token","is助詞Token","create読点Matcher","createKeyFromKey","concatJoishiTokens","ownKeys","e","r","t","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","obj","key","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","token","test","pos","pos_detail_1","commaCharacters","is読点Token","includes","surface_form","concatToken","aToken","bToken","tokens","newTokens","prevToken","concat","pos_detail_2","pos_detail_3","split"],"sources":["../src/token-utils.ts"],"sourcesContent":["// LICENSE : MIT\n\"use strict\";\n\nimport type { KuromojiToken } from \"kuromojin\";\n\n// 助詞どうか\nexport const is助詞Token = (token: KuromojiToken) => {\n    // 結合しているtokenは助詞助詞のようになってるため先頭一致で見る\n    return token && /^助詞/.test(token.pos);\n};\n\nexport const is括弧Token = (token: KuromojiToken) => {\n    return token && token.pos === \"記号\" && (token.pos_detail_1 === \"括弧開\" || token.pos_detail_1 === \"括弧閉\");\n};\n\n/**\n * 読点を判定する関数を返す\n * 注意: 名詞や記号ではないトークンは読点として扱えない\n * @param commaCharacters\n */\nexport const create読点Matcher = (commaCharacters: string[]) => {\n    return function is読点Token(token: KuromojiToken) {\n        return (\n            commaCharacters.includes(token.surface_form) &&\n            // 、や, は名詞扱いの場合がある(0.1.2で記号となる)\n            (token.pos === \"名詞\" ||\n                // ，は記号 && 読点となる(surface_formを優先するために pos_detail_1/読点 のチェックを省く)\n                token.pos === \"記号\")\n        );\n    };\n};\n/**\n * aTokenの_extraKeyに結合したkeyを追加する\n * @param {Object} aToken\n * @param {Object} bToken\n * @returns {Object}\n */\nconst concatToken = (aToken: KuromojiToken, bToken: KuromojiToken) => {\n    return {\n        ...aToken,\n        surface_form: aToken.surface_form + bToken.surface_form,\n        pos: aToken.pos + bToken.pos,\n        pos_detail_1: aToken.pos_detail_1 + bToken.surface_form\n    };\n};\n/**\n * 助詞+助詞 というように連続しているtokenを結合し直したtokenの配列を返す\n * @param {Array} tokens\n * @returns {Array}\n */\nexport const concatJoishiTokens = (tokens: readonly KuromojiToken[]) => {\n    const newTokens: KuromojiToken[] = [];\n    tokens.forEach((token) => {\n        const prevToken = newTokens[newTokens.length - 1];\n        if (is助詞Token(token) && is助詞Token(prevToken)) {\n            newTokens[newTokens.length - 1] = concatToken(prevToken, token);\n        } else {\n            newTokens.push(token);\n        }\n    });\n    return newTokens;\n};\n// 助詞tokenから品詞細分類1までを元にしたkeyを作る\n// http://www.unixuser.org/~euske/doc/postag/index.html#chasen\n// http://chasen.naist.jp/snapshot/ipadic/ipadic/doc/ipadic-ja.pdf\nexport const createKeyFromKey = (token: KuromojiToken) => {\n    // e.g.) \"は:助詞.係助詞.*.*\"\n    // \"しようとすると\" と には次の違いある\n    // と\t助詞\t格助詞\t一般 *\n    // と\t助詞\t接続助詞\t*\t*\n    return `${token.surface_form}:${token.pos}.${token.pos_detail_1}.${token.pos_detail_2}.${token.pos_detail_3}`;\n};\n// keyからsurfaceを取り出す\nexport const restoreToSurfaceFromKey = (key: string) => {\n    return key.split(\":\")[0];\n};\n"],"mappings":"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"}